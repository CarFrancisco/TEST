{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Type":"ANY_ELEMENTARY, ENUM","Var":"Id_Local"},{"__type":"PRM","Arg":"In2","Ix":1,"Type":"ANY_ELEMENTARY, ENUM","Var":"-1"}],"Ix":7,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"InOut","IO":true,"Ix":2,"Type":"ANY_INT","Var":"My_FH.Sta.Id_Max"}],"Ix":8,"Name":"Inc","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"InOut","IO":true,"Ix":3,"Type":"ANY_INT","Var":"My_FH.Sta.Id_Max"},{"__type":"PRM","Arg":"","Ix":4,"Type":"BOOL","Var":""}],"X":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":5,"Type":"ANY","Var":"My_FH.Sta.Id_Max"}],"Ix":9,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":6,"Type":"ANY","Var":"Id_Local"}],"X":2}],"CMT":"______________________________________________________________________________________________________\u000a¦  First run                                                                                                                                            ¦\u000a¦______________________________________________________________________________________________________¦\u000d\u000a\u000d\u000aDefine local ID","LRI":10,"RRI":11,"VLs":[]}
{"CLs":[{"__type":"LD","Var":"Enabled"},{"__type":"LD","Ix":1,"Not":true,"Var":"First_Read","X":1},{"__type":"ST","Ix":2,"Var":"Order_Read","X":2}],"CMT":"______________________________________________________________________________________________________\u000a¦  Order                                                                                                                                               ¦\u000a¦______________________________________________________________________________________________________¦\u000d\u000a\u000d\u000aAt begining, read current value","LRI":3,"RRI":4,"VLs":[]}
{"CLs":[{"__type":"LD","Var":"Enabled"},{"__type":"LD","Ix":1,"Var":"First_Read","X":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":3,"Type":"ANY_ELEMENTARY, ENUM","Var":"Data"},{"__type":"PRM","Arg":"In2","Ix":4,"Type":"ANY_ELEMENTARY, ENUM","Var":"Data_Backup"}],"Ix":5,"Name":"<>","Out":[{"__type":"PF","Arg":""}],"X":2},{"__type":"ST","Ix":2,"Var":"Order_Write","X":3}],"CMT":"Condition de write value","LRI":6,"RRI":7,"VLs":[]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":1,"Type":"ANY_ELEMENTARY, ENUM","Var":"R"},{"__type":"PRM","Arg":"In2","Ix":2,"Type":"ANY_ELEMENTARY, ENUM","Var":"0"}],"Ix":5,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"LD","Var":"Order_Read","X":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":3,"Type":"ANY","Var":"10"}],"Ix":6,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":4,"Type":"ANY","Var":"R"}],"X":2}],"CMT":"______________________________________________________________________________________________________\u000a¦  Execute command read                                                                                                                   ¦\u000a¦______________________________________________________________________________________________________¦\u000d\u000a\u000d\u000a0: Wait order","LRI":7,"RRI":8,"VLs":[]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":3,"Type":"ANY_ELEMENTARY, ENUM","Var":"R"},{"__type":"PRM","Arg":"In2","Ix":4,"Type":"ANY_ELEMENTARY, ENUM","Var":"10"}],"Ix":7,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"LD","Var":"My_FH.Sta.Ready","X":1},{"__type":"LD","Ix":1,"Not":true,"Var":"My_FH.Cmd.Order","X":2},{"__type":"ST","Ix":2,"S":true,"Var":"My_FH.Cmd.Order","X":3},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":5,"Type":"ANY","Var":"20"}],"Ix":8,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":6,"Type":"ANY","Var":"R"}],"X":3,"Y":1}],"CMT":"10: Check if FH is ready to receive an order ","LRI":9,"RRI":10,"VLs":[{"Ix":11,"X":3}]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Type":"ANY_ELEMENTARY, ENUM","Var":"R"},{"__type":"PRM","Arg":"In2","Ix":1,"Type":"ANY_ELEMENTARY, ENUM","Var":"20"}],"Ix":2,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"IST","EID":"d209cf6a-c581-4b40-aaa6-e1ee8f014718","H":265,"Ix":3,"TXT":"\/\/ Set unit datas commande code\u000d\u000aMy_FH.Cmd.Code := 16#401000;\u0009\u0009\u0009\u0009\u0009\u0009\/\/ \u0009Write code\u000d\u000aMy_FH.Cmd.Parameter_0 := Unit;\u0009\u0009\u0009\u0009\u0009\u0009\/\/ Unit number\u000d\u000aMy_FH.Cmd.Parameter_1 := External_Ref;\u0009\u0009\u0009\/\/ Data number in the external reference tables\u000d\u000aMy_FH.Cmd.Parameter_2 := 0;\u0009\u0009\u0009\u0009\u0009\u0009\u0009\u0009\/\/ Not used\u000d\u000aMy_FH.Cmd.Parameter_3 := 0;\u0009\u0009\u0009\u0009\u0009\u0009\u0009\u0009\/\/ Not used\u000d\u000a\u000d\u000a\/\/ Get the local ID\u000d\u000aMy_FH.Cmd.Id_Currant := Id_Local;\u000d\u000a\u000d\u000a\/\/ Go to next step\u000d\u000aR := 30;","W":753,"X":1}],"CMT":"20: Write parameters","LRI":4,"RRI":5,"VLs":[]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":1,"Type":"ANY_ELEMENTARY, ENUM","Var":"R"},{"__type":"PRM","Arg":"In2","Ix":2,"Type":"ANY_ELEMENTARY, ENUM","Var":"30"}],"Ix":5,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"LD","Var":"My_FH.Sta.Done","X":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":3,"Type":"ANY","Var":"40"}],"Ix":6,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":4,"Type":"ANY","Var":"R"}],"X":2}],"CMT":"30: Wait until FH give feedback (Config SET status done)","LRI":7,"RRI":8,"VLs":[]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":2,"Type":"ANY_ELEMENTARY, ENUM","Var":"R"},{"__type":"PRM","Arg":"In2","Ix":3,"Type":"ANY_ELEMENTARY, ENUM","Var":"40"}],"Ix":6,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"ST","Ix":1,"S":true,"Var":"My_FH.Cmd.Done","X":1},{"__type":"LD","Not":true,"Var":"My_FH.Sta.Done","X":1,"Y":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":4,"Type":"ANY","Var":"50"}],"Ix":7,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":5,"Type":"ANY","Var":"R"}],"X":2,"Y":1},{"__type":"HL","X":2}],"CMT":"40: Handshake Done from config","LRI":8,"RRI":9,"VLs":[{"Ix":10,"X":1}]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Type":"ANY_ELEMENTARY, ENUM","Var":"R"},{"__type":"PRM","Arg":"In2","Ix":1,"Type":"ANY_ELEMENTARY, ENUM","Var":"50"}],"Ix":2,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"IST","EID":"271f7e92-ff54-4d81-a5d7-2518ed28b4c7","H":124,"Ix":3,"TXT":"\/\/ Read parameter\u000d\u000aData_Backup := DINT_TO_REAL(My_FH.Respond.Data)\/1000;\u000d\u000a\u000d\u000a\/\/ Go to next step\u000d\u000aR := 100;","W":735,"X":1}],"CMT":"50: Read parameter","LRI":4,"RRI":5,"VLs":[]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":7,"Type":"ANY_ELEMENTARY, ENUM","Var":"R"},{"__type":"PRM","Arg":"In2","Ix":8,"Type":"ANY_ELEMENTARY, ENUM","Var":"100"}],"Ix":11,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"LD","Not":true,"Var":"My_FH.Sta.Fault","X":1},{"__type":"ST","Ix":2,"RS":true,"Var":"Fault","X":2},{"__type":"LD","Ix":1,"Var":"My_FH.Sta.Fault","X":1,"Y":1},{"__type":"ST","Ix":4,"S":true,"Var":"Fault","X":2,"Y":1},{"__type":"ST","Ix":5,"RS":true,"Var":"My_FH.Cmd.Done","X":1,"Y":2},{"__type":"ST","Ix":3,"RS":true,"Var":"My_FH.Cmd.Order","X":1,"Y":3},{"__type":"ST","Ix":6,"S":true,"Var":"First_Read","X":1,"Y":4},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":9,"Type":"ANY","Var":"0"}],"Ix":12,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":10,"Type":"ANY","Var":"R"}],"X":1,"Y":5},{"__type":"HL","X":2,"Y":2},{"__type":"HL","X":2,"Y":3},{"__type":"HL","X":2,"Y":4},{"__type":"HL","X":2,"Y":5}],"CMT":"100: Reset done status to handshake config bloc AND wait and of order","LRI":13,"RRI":14,"VLs":[{"Ix":15,"X":1},{"Ix":15,"X":1,"Y":1},{"Ix":15,"X":1,"Y":2},{"Ix":15,"X":1,"Y":3},{"Ix":15,"X":1,"Y":4}]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":1,"Type":"ANY_ELEMENTARY, ENUM","Var":"S"},{"__type":"PRM","Arg":"In2","Ix":2,"Type":"ANY_ELEMENTARY, ENUM","Var":"0"}],"Ix":5,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"LD","Var":"Order_Write","X":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":3,"Type":"ANY","Var":"10"}],"Ix":6,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":4,"Type":"ANY","Var":"S"}],"X":2}],"CMT":"______________________________________________________________________________________________________\u000a¦  Execute command write                                                                                                                  ¦\u000a¦______________________________________________________________________________________________________¦\u000d\u000a\u000d\u000a0: Wait order","LRI":7,"RRI":8,"VLs":[]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":3,"Type":"ANY_ELEMENTARY, ENUM","Var":"S"},{"__type":"PRM","Arg":"In2","Ix":4,"Type":"ANY_ELEMENTARY, ENUM","Var":"10"}],"Ix":7,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"LD","Var":"My_FH.Sta.Ready","X":1},{"__type":"LD","Ix":1,"Not":true,"Var":"My_FH.Cmd.Order","X":2},{"__type":"ST","Ix":2,"S":true,"Var":"My_FH.Cmd.Order","X":3},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":5,"Type":"ANY","Var":"20"}],"Ix":8,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":6,"Type":"ANY","Var":"S"}],"X":3,"Y":1}],"CMT":"10: Check if FH is ready to receive an order ","LRI":9,"RRI":10,"VLs":[{"Ix":11,"X":3}]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Type":"ANY_ELEMENTARY, ENUM","Var":"S"},{"__type":"PRM","Arg":"In2","Ix":1,"Type":"ANY_ELEMENTARY, ENUM","Var":"20"}],"Ix":2,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"IST","EID":"97479781-f186-44ea-8ff3-a352f677d375","H":249,"Ix":3,"TXT":"\/\/ Set unit datas commande code\u000d\u000aMy_FH.Cmd.Code := 16#501000;\u0009\u0009\u0009\u0009\u0009\u0009\/\/ \u0009Write code\u000d\u000aMy_FH.Cmd.Parameter_0 := Unit;\u0009\u0009\u0009\u0009\u0009\u0009\/\/ Unit number\u000d\u000aMy_FH.Cmd.Parameter_1 := External_Ref;\u0009\u0009\u0009\/\/ Data number in the external reference tables\u000d\u000aMy_FH.Cmd.Parameter_2 := REAL_TO_DINT(Data * 1000);\u0009\u0009\/\/ Data to be set (With factor x1000)\u000d\u000aMy_FH.Cmd.Parameter_3 := 0;\u0009\u0009\u0009\u0009\u0009\u0009\u0009\u0009\/\/ Not used\u000d\u000a\u000d\u000a\/\/ Get the local ID\u000d\u000aMy_FH.Cmd.Id_Currant := Id_Local;\u000d\u000a\u000d\u000a\/\/ Go to next step\u000d\u000aS := 30;","W":705,"X":1}],"CMT":"20: Write parameters","LRI":4,"RRI":5,"VLs":[]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":1,"Type":"ANY_ELEMENTARY, ENUM","Var":"S"},{"__type":"PRM","Arg":"In2","Ix":2,"Type":"ANY_ELEMENTARY, ENUM","Var":"30"}],"Ix":5,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"LD","Var":"My_FH.Sta.Done","X":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":3,"Type":"ANY","Var":"40"}],"Ix":6,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":4,"Type":"ANY","Var":"S"}],"X":2}],"CMT":"30: Wait until FH give feedback (Config SET status done)","LRI":7,"RRI":8,"VLs":[]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":2,"Type":"ANY_ELEMENTARY, ENUM","Var":"S"},{"__type":"PRM","Arg":"In2","Ix":3,"Type":"ANY_ELEMENTARY, ENUM","Var":"40"}],"Ix":6,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"ST","Ix":1,"S":true,"Var":"My_FH.Cmd.Done","X":1},{"__type":"LD","Not":true,"Var":"My_FH.Sta.Done","X":1,"Y":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":4,"Type":"ANY","Var":"100"}],"Ix":7,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":5,"Type":"ANY","Var":"S"}],"X":2,"Y":1},{"__type":"HL","X":2}],"LRI":8,"RRI":9,"VLs":[{"Ix":10,"X":1}]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":7,"Type":"ANY_ELEMENTARY, ENUM","Var":"S"},{"__type":"PRM","Arg":"In2","Ix":8,"Type":"ANY_ELEMENTARY, ENUM","Var":"100"}],"Ix":13,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"ST","Ix":2,"Var":"Done","X":1},{"__type":"LD","Not":true,"Var":"My_FH.Sta.Fault","X":1,"Y":1},{"__type":"ST","Ix":3,"RS":true,"Var":"Fault","X":2,"Y":1},{"__type":"LD","Ix":1,"Var":"My_FH.Sta.Fault","X":1,"Y":2},{"__type":"ST","Ix":5,"S":true,"Var":"Fault","X":2,"Y":2},{"__type":"ST","Ix":6,"RS":true,"Var":"My_FH.Cmd.Done","X":1,"Y":3},{"__type":"ST","Ix":4,"RS":true,"Var":"My_FH.Cmd.Order","X":1,"Y":4},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":11,"Type":"ANY","Var":"Data"}],"Ix":15,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":12,"Type":"ANY","Var":"Data_Backup"}],"X":1,"Y":5},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":9,"Type":"ANY","Var":"0"}],"Ix":14,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":10,"Type":"ANY","Var":"S"}],"X":2,"Y":5},{"__type":"HL","X":2},{"__type":"HL","X":2,"Y":3},{"__type":"HL","X":2,"Y":4}],"CMT":"100: Reset done status to handshake config bloc AND wait and of order","LRI":16,"RRI":17,"VLs":[{"Ix":18,"X":1},{"Ix":18,"X":1,"Y":1},{"Ix":18,"X":1,"Y":2},{"Ix":18,"X":1,"Y":3},{"Ix":18,"X":1,"Y":4}]}
