{"CLs":[{"__type":"LD","Not":true,"Var":"ENO"},{"__type":"JMP","Ix":1,"Label":"EndFB","X":1}],"LRI":2,"VLs":[]}
{"CLs":[{"__type":"LD","Var":"Enabled"},{"__type":"ST","Ix":1,"Var":"MyMaint.TypeUse.ScheduleTime","X":1},{"__type":"ST","Ix":2,"Var":"MyMaint.Sta.Used","X":1,"Y":1}],"CMT":"Config\u000d\u000a\u000d\u000aScheduled time maintenance","LRI":3,"RRI":4,"VLs":[{"Ix":5,"X":1}]}
{"CLs":[{"__type":"LD","Var":"Enabled"},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":3,"Type":"ANY_ELEMENTARY, ENUM","Var":"maint_step"},{"__type":"PRM","Arg":"In2","Ix":4,"Type":"ANY_ELEMENTARY, ENUM","Var":"10"}],"Ix":8,"Name":"<>","Out":[{"__type":"PF","Arg":""}],"X":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":5,"Type":"ANY_ELEMENTARY, ENUM","Var":"maint_step"},{"__type":"PRM","Arg":"In2","Ix":6,"Type":"ANY_ELEMENTARY, ENUM","Var":"20"}],"Ix":9,"Name":"<>","Out":[{"__type":"PF","Arg":""}],"X":2},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":1,"Type":"ANY","Var":"0"}],"Ix":7,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":2,"Type":"ANY","Var":"maint_step"}],"X":3}],"LRI":10,"RRI":11,"VLs":[]}
{"CLs":[{"__type":"LD","Not":true,"Var":"Enabled"},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":4,"Type":"ANY","Var":"-1"}],"Ix":6,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":5,"Type":"ANY","Var":"maint_step"}],"X":1},{"__type":"ST","Ix":1,"RS":true,"Var":"MyMaint.Sta.Warning","X":1,"Y":1},{"__type":"ST","Ix":3,"RS":true,"Var":"MyMaint.Sta.OnDuty","X":2,"Y":1},{"__type":"ST","Ix":2,"RS":true,"Var":"MyMaint.Sta.Idle","X":3,"Y":1},{"__type":"HL","X":2},{"__type":"HL","X":3}],"LRI":7,"RRI":8,"VLs":[{"Ix":9,"X":1}]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":1,"Type":"ANY_ELEMENTARY, ENUM","Var":"maint_step"},{"__type":"PRM","Arg":"In2","Ix":2,"Type":"ANY_ELEMENTARY, ENUM","Var":"0"}],"Ix":13,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"ST","Var":"MyMaint.Sta.Idle","X":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":7,"Type":"ANY","Var":"T#0s"}],"Ix":16,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":8,"Type":"ANY","Var":"MyMaint.Info.Time_left"}],"X":1,"Y":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":9,"Type":"ANY","Var":"T#0s"}],"Ix":17,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":10,"Type":"ANY","Var":"MyMaint.Info.Time_warning"}],"X":1,"Y":2},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":11,"Type":"ANY","Var":"Time_input"}],"Ix":18,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":12,"Type":"ANY","Var":"MyMaint.Info.Time_input"}],"X":1,"Y":3},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":3,"Type":"ANY_ELEMENTARY(except BOOL)","Var":"MyMaint.Info.Time_input"},{"__type":"PRM","Arg":"In2","Ix":4,"Type":"ANY_ELEMENTARY(except BOOL)","Var":"T#0s"}],"Ix":14,"Name":">","Out":[{"__type":"PF","Arg":""}],"X":1,"Y":4,"PL":true},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":5,"Type":"ANY","Var":"10"}],"Ix":15,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":6,"Type":"ANY","Var":"maint_step"}],"X":2,"Y":4},{"__type":"HL","X":2},{"__type":"HL","X":2,"Y":1},{"__type":"HL","X":2,"Y":2},{"__type":"HL","X":2,"Y":3}],"CMT":"Idle state\u000d\u000a\u000d\u000aTransition to OnDuty","LRI":19,"RRI":20,"VLs":[{"Ix":21,"X":1},{"Ix":21,"X":1,"Y":1},{"Ix":21,"X":1,"Y":2},{"Ix":21,"X":1,"Y":3}]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":1,"Type":"ANY_ELEMENTARY, ENUM","Var":"maint_step"},{"__type":"PRM","Arg":"In2","Ix":2,"Type":"ANY_ELEMENTARY, ENUM","Var":"10"}],"Ix":18,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"ST","Var":"MyMaint.Sta.OnDuty","X":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":14,"Type":"ANY","Var":"T#0s"}],"Ix":23,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":15,"Type":"ANY","Var":"MyMaint.Info.Time_warning"}],"X":1,"Y":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":12,"Type":"ANY_ELEMENTARY, ENUM","Var":"MyMaint.Info.Date_Next_Maint"},{"__type":"PRM","Arg":"In2","Ix":13,"Type":"ANY_ELEMENTARY, ENUM","Var":"DT#1970-1-1-0:0:0"}],"Ix":22,"Name":"=","Out":[{"__type":"PF","Arg":""}],"X":1,"Y":2,"PL":true},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":6,"Type":"DATE_AND_TIME","Var":"_CurrentTime"},{"__type":"PRM","Arg":"In2","Ix":7,"Type":"TIME","Var":"Time_input"}],"Ix":20,"Name":"ADD_DT_TIME","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"","Ix":8,"Type":"DATE_AND_TIME","Var":"MyMaint.Info.Date_Next_Maint"}],"X":2,"Y":2},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":16,"Type":"ANY_ELEMENTARY(except BOOL)","Var":"_CurrentTime"},{"__type":"PRM","Arg":"In2","Ix":17,"Type":"ANY_ELEMENTARY(except BOOL)","Var":"MyMaint.Info.Date_Next_Maint"}],"Ix":24,"Name":"<","Out":[{"__type":"PF","Arg":""}],"X":1,"Y":3,"PL":true},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":3,"Type":"DATE_AND_TIME","Var":"MyMaint.Info.Date_Next_Maint"},{"__type":"PRM","Arg":"In2","Ix":4,"Type":"DATE_AND_TIME","Var":"_CurrentTime"}],"Ix":19,"Name":"SUB_DT_DT","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"","Ix":5,"Type":"TIME","Var":"MyMaint.Info.Time_left"}],"X":2,"Y":3},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":9,"Type":"TIME","Var":"Time_input"},{"__type":"PRM","Arg":"In2","Ix":10,"Type":"TIME","Var":"MyMaint.Info.Time_left"}],"Ix":21,"Name":"SUB_TIME","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"","Ix":11,"Type":"TIME","Var":"Time_Span_Passed"}],"X":3,"Y":3},{"__type":"HL","X":2},{"__type":"HL","X":3},{"__type":"HL","X":2,"Y":1},{"__type":"HL","X":3,"Y":1},{"__type":"HL","X":3,"Y":2}],"CMT":"On duty state","LRI":25,"RRI":26,"VLs":[{"Ix":27,"X":1},{"Ix":27,"X":1,"Y":1},{"Ix":27,"X":1,"Y":2}]}
{"CLs":[{"__type":"LD","Var":"MyMaint.Sta.OnDuty"},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":16,"Type":"ANY_ELEMENTARY, ENUM","Var":"MyMaint.Info.Date_Next_Maint"},{"__type":"PRM","Arg":"In2","Ix":17,"Type":"ANY_ELEMENTARY, ENUM","Var":"DT#1970-1-1-0:0:0"}],"Ix":25,"Name":"<>","Out":[{"__type":"PF","Arg":""}],"X":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":12,"Type":"ANY_ELEMENTARY(except BOOL)","Var":"_CurrentTime"},{"__type":"PRM","Arg":"In2","Ix":13,"Type":"ANY_ELEMENTARY(except BOOL)","Var":"MyMaint.Info.Date_Next_Maint"}],"Ix":23,"Name":">=","Out":[{"__type":"PF","Arg":""}],"X":2,"PL":true},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":1,"Type":"ANY_NUM, STRING","Var":"MyMaint.Info.Counter_warning"},{"__type":"PRM","Arg":"In2","Ix":2,"Type":"ANY_NUM, STRING","Var":"1"}],"Ix":18,"Name":"ADD","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"","Ix":3,"Type":"ANY_NUM, STRING","Var":"MyMaint.Info.Counter_warning"}],"X":3,"PL":true},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":4,"Type":"ANY","Var":"_CurrentTime"}],"Ix":19,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":5,"Type":"ANY","Var":"Date_Warning"}],"X":3,"Y":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":6,"Type":"ANY","Var":"20"}],"Ix":20,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":7,"Type":"ANY","Var":"maint_step"}],"X":3,"Y":2},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":10,"Type":"ANY_ELEMENTARY, ENUM","Var":"Time_input"},{"__type":"PRM","Arg":"In2","Ix":11,"Type":"ANY_ELEMENTARY, ENUM","Var":"T#0s"}],"Ix":22,"Name":"=","Out":[{"__type":"PF","Arg":""}],"X":1,"Y":3,"PL":true},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":14,"Type":"ANY_ELEMENTARY, ENUM","Var":"Time_input"},{"__type":"PRM","Arg":"In2","Ix":15,"Type":"ANY_ELEMENTARY, ENUM","Var":"MyMaint.Info.Time_input"}],"Ix":24,"Name":"<>","Out":[{"__type":"PF","Arg":""}],"X":1,"Y":4},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":8,"Type":"ANY","Var":"0"}],"Ix":21,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":9,"Type":"ANY","Var":"maint_step"}],"X":2,"Y":3},{"__type":"HL","X":3,"Y":3}],"CMT":"OnDuty state\u000d\u000a\u000d\u000aTransition to Warning\u000d\u000aTransition to Idle","LRI":26,"RRI":27,"VLs":[{"Ix":28,"X":3},{"Ix":28,"X":3,"Y":1},{"Ix":29,"X":1},{"Ix":29,"X":1,"Y":1},{"Ix":29,"X":1,"Y":2},{"Ix":29,"X":1,"Y":3},{"Ix":30,"X":2,"Y":3}]}
{"CLs":[{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":2,"Type":"ANY_ELEMENTARY, ENUM","Var":"maint_step"},{"__type":"PRM","Arg":"In2","Ix":3,"Type":"ANY_ELEMENTARY, ENUM","Var":"20"}],"Ix":9,"Name":"=","Out":[{"__type":"PF","Arg":""}],"PL":true},{"__type":"ST","Var":"MyMaint.Sta.Warning","X":1},{"__type":"ST","Ix":1,"Var":"MyMaint.Needed","X":1,"Y":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":4,"Type":"DATE_AND_TIME","Var":"_CurrentTime"},{"__type":"PRM","Arg":"In2","Ix":5,"Type":"DATE_AND_TIME","Var":"Date_Warning"}],"Ix":10,"Name":"SUB_DT_DT","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"","Ix":6,"Type":"TIME","Var":"MyMaint.Info.Time_warning"}],"X":1,"Y":2},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":7,"Type":"ANY","Var":"T#0s"}],"Ix":11,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":8,"Type":"ANY","Var":"MyMaint.Info.Time_left"}],"X":1,"Y":3}],"CMT":"Warning state","LRI":12,"RRI":13,"VLs":[{"Ix":14,"X":1},{"Ix":14,"X":1,"Y":1},{"Ix":14,"X":1,"Y":2}]}
{"CLs":[{"__type":"LD","Var":"MyMaint.Sta.Warning"},{"__type":"LD","Ix":1,"Var":"MyMaint.Cmd.Done","X":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":4,"Type":"ANY","Var":"_CurrentTime"}],"Ix":13,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":5,"Type":"ANY","Var":"Date_Done"}],"X":2},{"__type":"IST","EID":"1c53de26-68fe-4ed4-b81d-de37d5ec6744","H":519.00000000000023,"Ix":17,"TXT":"\/\/ Replace the old data with the new one\u000d\u000aFOR i:=3 TO 1 BY -1 DO\u0009 \u000d\u000a\u0009MyMaint.History[i].Date_Request := MyMaint.History[i-1].Date_Request;\u0009\u000d\u000a\u0009MyMaint.History[i].Date_Done := MyMaint.History[i-1].Date_Done;\u000d\u000a\u0009MyMaint.History[i].t_Missed := MyMaint.History[i-1].t_Missed;\u000d\u000a\u0009MyMaint.History[i].N_Missed := MyMaint.History[i-1].N_Missed;\u000d\u000aEND_FOR;\u000d\u000a\u000d\u000a\/\/ date of warning means only the time when it switched from OnDuty to Warning state (it happens only when the PLC runs)\u000d\u000aMyMaint.History[0].Date_Request := Date_Warning;\u000d\u000a\/\/ Copy the current time\u000d\u000aMyMaint.History[0].Date_Done := Date_Done;\u000d\u000a\/\/ missed time = date done - date next\u000d\u000aMyMaint.History[0].t_Missed := SUB_DT_DT(MyMaint.History[0].Date_Done, MyMaint.Info.Date_Next_Maint);\u000d\u000a\u000d\u000a\/\/ basically N missed = missed time \/ input time\u000d\u000aTime_Missed := MyMaint.History[0].t_Missed;\u000d\u000aWHILE Time_Missed >= Time_input DO\u000d\u000a\u0009Time_Missed := SUB_TIME(Time_Missed, Time_input);\u000d\u000a\u0009Missed_maintenace := Missed_maintenace + 1;\u000d\u000a\u0009IF Missed_maintenace > 1000 THEN\u000d\u000a\u0009\u0009EXIT;\u000d\u000a\u0009END_IF;\u000d\u000aEND_WHILE;\u000d\u000aMyMaint.History[0].N_Missed := Missed_maintenace;\u000d\u000a\u000d\u000a\/\/ next time = next time + input time * (missed number + 1)\u000d\u000aMyMaint.Info.Date_Next_Maint := ADD_DT_TIME(MyMaint.Info.Date_Next_Maint, MULTIME(Time_input, (Missed_maintenace+1)));\u000d\u000aMissed_maintenace := 0;","W":924,"X":2,"Y":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":11,"Type":"ANY_ELEMENTARY(except BOOL)","Var":"_CurrentTime"},{"__type":"PRM","Arg":"In2","Ix":12,"Type":"ANY_ELEMENTARY(except BOOL)","Var":"MyMaint.Info.Date_Next_Maint"}],"Ix":16,"Name":">","Out":[{"__type":"PF","Arg":""}],"X":2,"Y":2,"PL":true},{"__type":"LD","Ix":2,"Var":"MyMaint.Cmd.ScheduleTime_Asynchronous","X":2,"Y":3},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":8,"Type":"DATE_AND_TIME","Var":"_CurrentTime"},{"__type":"PRM","Arg":"In2","Ix":9,"Type":"TIME","Var":"Time_input"}],"Ix":15,"Name":"ADD_DT_TIME","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"","Ix":10,"Type":"DATE_AND_TIME","Var":"MyMaint.Info.Date_Next_Maint"}],"X":3,"Y":2},{"__type":"ST","Ix":3,"RS":true,"Var":"MyMaint.Cmd.Done","X":2,"Y":4},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":6,"Type":"ANY","Var":"10"}],"Ix":14,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":7,"Type":"ANY","Var":"maint_step"}],"X":2,"Y":5},{"__type":"HL","X":3},{"__type":"HL","X":3,"Y":1},{"__type":"HL","X":3,"Y":4},{"__type":"HL","X":3,"Y":5}],"CMT":"Warning state\u000d\u000a\u000d\u000aDone Button - Transition to OnDuty","LRI":18,"RRI":19,"VLs":[{"Ix":20,"X":2},{"Ix":20,"X":2,"Y":1},{"Ix":20,"X":2,"Y":2},{"Ix":20,"X":2,"Y":3},{"Ix":20,"X":2,"Y":4},{"Ix":21,"X":3,"Y":2}]}
{"CLs":[{"__type":"LD","Var":"MyMaint.Cmd.ResetCounter"},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":2,"Type":"ANY","Var":"0"}],"Ix":4,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":3,"Type":"ANY","Var":"MyMaint.Info.Counter_warning"}],"X":1},{"__type":"ST","Ix":1,"RS":true,"Var":"MyMaint.Cmd.ResetCounter","X":1,"Y":1}],"CMT":"Counter reset","LRI":5,"RRI":6,"VLs":[{"Ix":7,"X":1}]}
{"CLs":[{"__type":"LD","Var":"Enabled"},{"__type":"LD","Dwn":true,"Id":"8b140022-d100-4f9c-8bf2-986c000000aa","Ix":1,"Var":"Enabled","Y":1},{"__type":"ST","Ix":2,"Var":"ENO","X":1}],"LI":3,"LRI":4,"Label":"EndFB","RRI":5,"VLs":[{"Ix":6,"X":1}]}
