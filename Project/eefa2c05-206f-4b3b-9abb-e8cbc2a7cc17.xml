{"CLs":[{"__type":"LD","Var":"P_First_Run"},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":1,"Type":"ANY_ELEMENTARY, ENUM","Var":"MyProd.Define[Id].Distance"},{"__type":"PRM","Arg":"In2","Ix":2,"Type":"ANY_ELEMENTARY, ENUM","Var":"0"}],"Ix":13,"Name":"=","Out":[{"__type":"PF","Arg":""}],"X":1,"PL":true},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":7,"Type":"ANY","Var":"Distance"}],"Ix":14,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":8,"Type":"ANY","Var":"MyProd.Define[Id].Distance"}],"X":2},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":3,"Type":"ANY_ELEMENTARY, ENUM","Var":"MyProd.Define[Id].Tol_Befor"},{"__type":"PRM","Arg":"In2","Ix":4,"Type":"ANY_ELEMENTARY, ENUM","Var":"0"}],"Ix":15,"Name":"=","Out":[{"__type":"PF","Arg":""}],"X":1,"Y":1,"PL":true},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":9,"Type":"ANY","Var":"Befor"}],"Ix":16,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":10,"Type":"ANY","Var":"MyProd.Define[Id].Tol_Befor"}],"X":2,"Y":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":5,"Type":"ANY_ELEMENTARY, ENUM","Var":"MyProd.Define[Id].Tol_After"},{"__type":"PRM","Arg":"In2","Ix":6,"Type":"ANY_ELEMENTARY, ENUM","Var":"0"}],"Ix":17,"Name":"=","Out":[{"__type":"PF","Arg":""}],"X":1,"Y":2,"PL":true},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":11,"Type":"ANY","Var":"After"}],"Ix":18,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":12,"Type":"ANY","Var":"MyProd.Define[Id].Tol_After"}],"X":2,"Y":2}],"CMT":"Init variables","LRI":19,"RRI":20,"VLs":[{"Ix":21,"X":1},{"Ix":21,"X":1,"Y":1}]}
{"CLs":[{"__type":"LD","Var":"Enabled"},{"__type":"LD","Id":"98841d48-f8ca-4a5a-b342-020f0000001a","Ix":1,"Up":true,"Var":"Alarms","X":1},{"__type":"ST","Ix":5,"S":true,"Var":"Alarm_Begin","X":2},{"__type":"LD","Dwn":true,"Id":"98841d48-f8ca-4a5a-b342-020f0000001b","Ix":2,"Var":"Alarms","X":1,"Y":1},{"__type":"LD","Ix":3,"Var":"Alarm_Occur","X":2,"Y":1},{"__type":"ST","Ix":6,"S":true,"Var":"Alarm_Stop","X":3,"Y":1},{"__type":"ST","Ix":7,"Var":"MyProd.Define[Id].Enabled","X":1,"Y":2},{"__type":"LD","Ix":4,"Var":"Alarms","X":1,"Y":3},{"__type":"ST","Ix":8,"Var":"MyProd.Define[Id].Occuring","X":2,"Y":3},{"__type":"HL","X":3},{"__type":"HL","X":2,"Y":2},{"__type":"HL","X":3,"Y":2},{"__type":"HL","X":3,"Y":3}],"CMT":"Order","LRI":9,"RRI":10,"VLs":[{"Ix":11,"X":1},{"Ix":11,"X":1,"Y":1},{"Ix":11,"X":1,"Y":2}]}
{"CLs":[{"__type":"LD","Var":"Alarm_Begin"},{"__type":"IST","EID":"dcc3e1a3-ba4d-4ffb-93ca-c74c7dbbf182","H":407,"Ix":1,"TXT":"\u000d\u000a\/\/ Check if old alarm is still there\u000d\u000aIF MyProd.Alarms[Pos_Last].Enabled AND MyProd.Alarms[Pos_Last].Id = Id THEN\u000d\u000a\u0009\u0009\u000d\u000a\u0009\u0009\/\/ New theoretical position\u000d\u000a\u0009\u0009tmp_NewPos := MyProd.Position + MyProd.Define[Id].Distance;\u000d\u000a\u0009\u0009\u000d\u000a\u0009\u0009\/\/ Check if the new alarms is in the same range as the old one\u000d\u000a\u0009\u0009IF tmp_NewPos >= MyProd.Alarms[Pos_Last].PosStart AND tmp_NewPos <= MyProd.Alarms[Pos_Last].PosStop THEN\u000d\u000a\u0009\u0009\u0009\u000d\u000a\u0009\u0009\u0009\/\/ Update datas of old alarm\u000d\u000a\u0009\u0009\u0009MyProd.Alarms[Pos_Last].State := TRUE;\u000d\u000a\u0009\u0009\u0009MyProd.Alarms[Pos_Last].PosStop := -1;\u000d\u000a\u000d\u000a\u0009\u0009\u0009\/\/ Save state of alarms\u000d\u000a\u0009\u0009\u0009Alarm_Begin := FALSE;\u000d\u000a\u0009\u0009\u0009Alarm_Occur := TRUE;\u000d\u000a\u0009\u0009\u0009\u000d\u000a\u0009\u0009END_IF;\u000d\u000aEND_IF;","W":927.00000000000023,"X":1}],"CMT":"______________________________________________________________________________________________________\u000a¦  Check if a new alarm is needed                                                                                                     ¦\u000a¦_____________________________________________________________________________________________________¦\u000d\u000a\u000d\u000aFind next free position on alarm event list","LRI":2,"RRI":3,"VLs":[]}
{"CLs":[{"__type":"LD","Var":"Alarm_Begin"},{"__type":"IST","EID":"80e5e233-75ad-442f-9c1e-e6fec46f42e6","H":496,"Ix":1,"TXT":"i := 0;\u000d\u000a\u000d\u000a\/\/ Find next free alarm event\u000d\u000aWHILE MyProd.Alarms[i].Enabled AND i < MyProd.Max_Alarms  DO\u000d\u000a\u0009Inc(i);\u000d\u000aEND_WHILE;\u000d\u000a\u000d\u000a\/\/ Check if alarm list is no full\u000d\u000aIF i < MyProd.Max_Alarms THEN\u000d\u000a\u0009\u0009\u000d\u000a\u0009\/\/ When position is find, backup it\u000d\u000a\u0009Pos := i;\u000d\u000a\u000d\u000a\u0009\/\/ If position of this alarm is bigger then last position, set new last position\u000d\u000a\u0009IF Pos > MyProd.Last_Alarm THEN\u000d\u000a\u0009\u0009MyProd.Last_Alarm := Pos;\u000d\u000a\u0009END_IF;\u000d\u000a\u0009\u000d\u000a\u0009\/\/ Increment the number of alarms\u000d\u000a\u0009Inc(MyProd.Counter_Alarms);\u000d\u000a\u0009\u000d\u000aELSE\u000d\u000a\u0009\/\/ When alarm list is full\u000d\u000a\u0009MyProd.Msg.TooMuchAlarm_Fault := TRUE;\u000d\u000aEND_IF;","W":708,"X":1}],"CMT":"______________________________________________________________________________________________________\u000a¦  When alarm begin.                                                                                                                         ¦\u000a¦_____________________________________________________________________________________________________¦\u000d\u000a\u000d\u000aFind next free position on alarm event list","LRI":2,"RRI":3,"VLs":[]}
{"CLs":[{"__type":"LD","Var":"Alarm_Begin"},{"__type":"IST","EID":"75515bbe-7d6b-45e6-b971-1e5f1240d23d","H":269,"Ix":1,"TXT":"\/\/ Save datas of alarms\u000d\u000aMyProd.Alarms[Pos].Enabled := TRUE;\u000d\u000aMyProd.Alarms[Pos].State := TRUE;\u000d\u000aMyProd.Alarms[Pos].PosStart := MyProd.Position + MyProd.Define[Id].Distance - MyProd.Define[Id].Tol_Befor;\u000d\u000aMyProd.Alarms[Pos].PosStop := -1;\u000d\u000aMyProd.Alarms[Pos].Id := Id;\u000d\u000aMyProd.Alarms[Pos].TimeStamp :=GetTime();\u000d\u000a\u000d\u000a\/\/ Save state of alarms\u000d\u000aAlarm_Begin := FALSE;\u000d\u000aAlarm_Occur := TRUE;","W":822.00000000000011,"X":1}],"CMT":"Save datas of alarms","LRI":2,"RRI":3,"VLs":[]}
{"CLs":[{"__type":"LD","Var":"Alarm_Stop"},{"__type":"IST","EID":"1d6813fc-1065-4fe4-8bad-5fbb56ef3ce1","H":265.00000000000011,"Ix":1,"TXT":"\/\/ Save datas of alarms\u000d\u000aMyProd.Alarms[Pos].PosStop := MyProd.Position + MyProd.Define[Id].Distance + MyProd.Define[Id].Tol_After;\u000d\u000aMyProd.Alarms[Pos].State := FALSE;\u000d\u000a\u000d\u000a\/\/ Save state of alarms\u000d\u000aAlarm_Begin := FALSE;\u000d\u000aAlarm_Occur := FALSE;\u000d\u000aAlarm_Stop  := FALSE;\u000d\u000a\u000d\u000a\/\/ Backup the last alarm\u000d\u000aPos_Last := Pos;","W":861,"X":1}],"CMT":"______________________________________________________________________________________________________\u000a¦  When alarm finish.                                                                                                                         ¦\u000a¦_____________________________________________________________________________________________________¦\u000d\u000a\u000d\u000aSave end of alarm position","LRI":2,"RRI":3,"VLs":[]}
{"CLs":[{"__type":"LD","Id":"98841d48-f8ca-4a5a-b342-020f0000003a","Up":true,"Var":"Command"},{"__type":"LD","Id":"98841d48-f8ca-4a5a-b342-020f0000003b","Ix":1,"Up":true,"Var":"MyProd.Define[Id].Selected","Y":1},{"__type":"ST","Ix":3,"S":true,"Var":"Command","X":1},{"__type":"ST","Ix":2,"S":true,"Var":"MyProd.Define[Id].Selected","X":2}],"CMT":"______________________________________________________________________________________________________\u000a¦  Command management                                                                                                                ¦\u000a¦_____________________________________________________________________________________________________¦\u000d\u000a\u000d\u000aSet order","LRI":4,"RRI":5,"VLs":[{"Ix":6,"X":1}]}
{"CLs":[{"__type":"LD","Dwn":true,"Id":"98841d48-f8ca-4a5a-b342-020f00000042","Var":"Command"},{"__type":"LD","Dwn":true,"Id":"98841d48-f8ca-4a5a-b342-020f00000043","Ix":1,"Var":"MyProd.Define[Id].Selected","Y":1},{"__type":"ST","Ix":3,"RS":true,"Var":"Command","X":1},{"__type":"ST","Ix":2,"RS":true,"Var":"MyProd.Define[Id].Selected","X":2}],"CMT":"Reset order","LRI":4,"RRI":5,"VLs":[{"Ix":6,"X":1}]}
