{"CLs":[{"__type":"LD","Ix":1,"Var":"P_On"},{"__type":"LD","Var":"Execute","X":1},{"__type":"ST","Ix":2,"Var":"Ramp_Start","X":2},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":3,"Type":"ANY","Var":"Velocity"}],"Ix":5,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":4,"Type":"ANY","Var":"Ramp_In"}],"X":1,"Y":1},{"__type":"HL","X":2,"Y":1}],"CMT":"Start the ramp generation","LRI":6,"RRI":7,"VLs":[{"Ix":8,"X":1}]}
{"CLs":[{"__type":"LD","Id":"a00709d6-8ee9-4a70-95fa-01c70000000c","Up":true,"Var":"Execute"},{"__type":"IST","EID":"74a4f928-b287-45df-8ab1-ea0e41dd9b17","H":59,"Ix":1,"TXT":"Ramp_Interval:=LINT_TO_LREAL(TimeToNanoSec(GetMyTaskInterval()))\/1000000000;","W":831,"X":1}],"CMT":"Check what is the actual PLC cycle time","LRI":2,"RRI":3,"VLs":[]}
{"CLs":[{"__type":"LD","Var":"P_On"},{"__type":"F","In":[{"__type":"PF","Arg":"EN"}],"Ix":9,"Name":"Get1sClk","Out":[{"__type":"PF","Arg":""}],"X":1},{"__type":"F","In":[{"__type":"PF","Arg":"In"}],"Ix":10,"Name":"Up","Out":[{"__type":"PF","Arg":""}],"X":2,"Id":"a00709d6-8ee9-4a70-95fa-01c70000001b"},{"__type":"IST","EID":"7304a699-97b4-4c1c-a8b9-0f428767a014","H":75,"Ix":15,"TXT":"Ramp_Step_Up:=Acceleration*Ramp_Interval;\u000d\u000aRamp_Step_Down:=Deceleration*Ramp_Interval;","W":812,"X":3},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":7,"Type":"ANY_ELEMENTARY(except BOOL)","Var":"0.0"},{"__type":"PRM","Arg":"In2","Ix":8,"Type":"ANY_ELEMENTARY(except BOOL)","Var":"Acceleration"}],"Ix":14,"Name":">=","Out":[{"__type":"PF","Arg":""}],"X":3,"Y":1,"PL":true},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":5,"Type":"ANY","Var":"9999"}],"Ix":13,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":6,"Type":"ANY","Var":"Ramp_Step_Up"}],"X":4,"Y":1},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In1","Ix":3,"Type":"ANY_ELEMENTARY(except BOOL)","Var":"0.0"},{"__type":"PRM","Arg":"In2","Ix":4,"Type":"ANY_ELEMENTARY(except BOOL)","Var":"Deceleration"}],"Ix":12,"Name":">=","Out":[{"__type":"PF","Arg":""}],"X":3,"Y":2,"PL":true},{"__type":"F","In":[{"__type":"PF","Arg":"EN"},{"__type":"PRM","Arg":"In","Ix":1,"Type":"ANY","Var":"9999"}],"Ix":11,"Name":"MOVE","Out":[{"__type":"PF","Arg":"ENO"},{"__type":"PRM","Arg":"Out","Ix":2,"Type":"ANY","Var":"Ramp_Step_Down"}],"X":4,"Y":2},{"__type":"HL","X":4}],"CMT":"Recompute time to time the steps up and down","LRI":16,"RRI":17,"VLs":[{"Ix":18,"X":3},{"Ix":18,"X":3,"Y":1}]}
{"CLs":[{"__type":"LD","Var":"P_On"},{"__type":"IST","EID":"3028220d-5758-4820-a45f-4392d16c7774","H":644,"Ix":1,"TXT":"\/\/  start the ramp ...\u000d\u000aIF Ramp_Start THEN\u000d\u000a\u0009Ramp_Started:=TRUE;\u000d\u000aELSE\u000d\u000a\u0009\/\/ ... or force it to 0\u000d\u000a\u0009Ramp_In:=0;\u000d\u000aEND_IF;\u000d\u000a\u000d\u000a\/\/ indicate when the ramp is running\u000d\u000aIF Ramp_Start=FALSE AND Ramp_In=Ramp_Out  THEN\u000d\u000a\u0009Ramp_Started:=FALSE;\u000d\u000aEND_IF;\u000d\u000a\u0009\u0009\u000d\u000aIF Ramp_Started THEN\u000d\u000a\u0009\/\/ ramp must go up....\u000d\u000a\u0009IF Ramp_Out<Ramp_In THEN\u000d\u000a\u0009\u0009Ramp_Out:=Ramp_Out+Ramp_Step_Up;\u000d\u000a\u0009\u0009\/\/ ... until it reach the setpoint (In)\u000d\u000a\u0009\u0009IF Ramp_Out>Ramp_In THEN\u000d\u000a\u0009\u0009\u0009Ramp_Out:=Ramp_In;\u000d\u000a\u0009\u0009END_IF;\u000d\u000a\u0009END_IF;\u000d\u000a\u0009\/\/ ramp must go down... \u000d\u000a\u0009IF Ramp_Out>Ramp_In THEN\u000d\u000a\u0009\u0009Ramp_Out:=Ramp_Out-Ramp_Step_Down;\u000d\u000a\u0009\u0009\/\/ ... until it reach the setpoint (In)\u000d\u000a\u0009\u0009IF Ramp_Out<Ramp_In THEN\u000d\u000a\u0009\u0009\u0009Ramp_Out:=Ramp_In;\u000d\u000a\u0009\u0009END_IF;\u000d\u000a\u0009END_IF;\u000d\u000aEND_IF;\u000d\u000a\u000d\u000a\u0009\u000d\u000a\u0009\u0009\u0009","W":965,"X":1}],"CMT":"Generate the ramp.\u000d\u000aIt's executed each PLC cylce\u000d\u000aIt start from 0 and goes to \"target Velocity\".\u000d\u000awhen the ramp is stopped, the ramp goes to 0.\u000d\u000a\u000d\u000aOne cylce is ensured with an 0 output befor indicateing the ramp is really stopped","LRI":2,"RRI":3,"VLs":[]}
{"CLs":[{"__type":"LD","Ix":1,"Var":"Ramp_Started"},{"__type":"LD","Not":true,"Var":"Axis.DrvStatus.CSV","X":1},{"__type":"FB","In":[{"__type":"PRM","Arg":"Axis","IO":true,"Ix":3,"Type":"_sAXIS_REF","Var":"Axis"},{"__type":"PF","Arg":"Execute"},{"__type":"PRM","Arg":"Velocity","Ix":4,"Type":"LREAL","Var":"Ramp_Out"},{"__type":"PRM","Arg":"CmdPosMode","Ix":5,"Type":"_eMC_CMDPOS_MODE","Var":"CmdPosMode"},{"__type":"PRM","Arg":"BufferMode","Ix":6,"Type":"_eMC_BUFFER_MODE","Var":"BufferMode"}],"Ix":13,"Name":"MC_SyncMoveVelocity","Out":[{"__type":"PRM","Arg":"Axis","IO":true,"Ix":7,"Type":"_sAXIS_REF","Var":"Axis"},{"__type":"PF","Arg":"InVelocity"},{"__type":"PRM","Arg":"Busy","Ix":8,"Type":"BOOL","Var":"Busy"},{"__type":"PRM","Arg":"Active","Ix":9,"Type":"BOOL","Var":"Active"},{"__type":"PRM","Arg":"CommandAborted","Ix":10,"Type":"BOOL","Var":"CommandAborted"},{"__type":"PRM","Arg":"Error","Ix":11,"Type":"BOOL","Var":"ErrorActive"},{"__type":"PRM","Arg":"ErrorID","Ix":12,"Type":"WORD","Var":"ErrorID"}],"X":2,"Var":"Servo_MoveVel_CSV"},{"__type":"ST","Ix":2,"S":true,"Var":"InVelocity","X":3}],"CMT":"Execute the original MC_SynchMoveVel\u000d\u000aThe bloc activate the CSV mode.\u000d\u000aOnce the mode CSV is activated for the axis, the block SHOULD NOT BE RE-EXECUTED!\u000d\u000a","LRI":14,"RRI":15,"VLs":[]}
{"CLs":[{"__type":"LD","Ix":1,"Var":"P_On"},{"__type":"LD","Dwn":true,"Id":"a00709d6-8ee9-4a70-95fa-01c70000003b","Var":"Ramp_Started","X":1},{"__type":"ST","Ix":3,"S":true,"Var":"Order_Stop","X":2},{"__type":"LD","Ix":2,"Var":"Order_Stop","X":1,"Y":1},{"__type":"FB","In":[{"__type":"PRM","Arg":"Axis","IO":true,"Ix":6,"Type":"_sAXIS_REF","Var":"Axis"},{"__type":"PF","Arg":"Execute"},{"__type":"PRM","Arg":"Deceleration","Ix":7,"Type":"LREAL","Var":"Deceleration"},{"__type":"PRM","Arg":"Jerk","Ix":8,"Type":"LREAL","Var":""},{"__type":"PRM","Arg":"BufferMode","Ix":9,"Type":"_eMC_BUFFER_MODE","Var":""}],"Ix":16,"Name":"MC_Stop_v2","Out":[{"__type":"PRM","Arg":"Axis","IO":true,"Ix":10,"Type":"_sAXIS_REF","Var":"Axis"},{"__type":"PF","Arg":"Done"},{"__type":"PRM","Arg":"Busy","Ix":11,"Type":"BOOL","Var":""},{"__type":"PRM","Arg":"Active","Ix":12,"Type":"BOOL","Var":""},{"__type":"PRM","Arg":"CommandAborted","Ix":13,"Type":"BOOL","Var":""},{"__type":"PRM","Arg":"ErrorActive","Ix":14,"Type":"BOOL","Var":""},{"__type":"PRM","Arg":"ErrorID","Ix":15,"Type":"WORD","Var":""}],"UD":true,"X":2,"Y":1,"Var":"Servo_Stop"},{"__type":"ST","Ix":5,"RS":true,"Var":"Order_Stop","X":3,"Y":1},{"__type":"ST","Ix":4,"RS":true,"Var":"InVelocity","X":4,"Y":1},{"__type":"HL","X":3},{"__type":"HL","X":4}],"CMT":"When we need to stop the SyncMoveVel, an MC_Stop must be executed","LRI":17,"RRI":18,"VLs":[{"Ix":19,"X":1}]}
